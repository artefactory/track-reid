
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../quickstart_dev/">
      
      
        <link rel="next" href="../reference/reid_processor/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Custom cost and selection functions - track-reid</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#designing-custom-cost-and-selection-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="track-reid" class="md-header__button md-logo" aria-label="track-reid" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            track-reid
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Custom cost and selection functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 12a10 10 0 0 0 13 9.54 10 10 0 0 1 0-19.08A10 10 0 0 0 2 12Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81 1.42-1.42M1 13h3v-2H1m12 9h-2v3h2"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="track-reid" class="md-nav__button md-logo" aria-label="track-reid" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    track-reid
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quickstart_user/" class="md-nav__link">
        Quickstart users
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quickstart_dev/" class="md-nav__link">
        Quickstart developers
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Custom cost and selection functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Custom cost and selection functions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-cost-function" class="md-nav__link">
    Custom cost function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-selection-function" class="md-nav__link">
    Custom Selection function
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/reid_processor/" class="md-nav__link">
        ReidProcessor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tracked_object_filter/" class="md-nav__link">
        TrackedObjectFilter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/matcher/" class="md-nav__link">
        Matcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tracked_object_metadata/" class="md-nav__link">
        TrackedObjectMetadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tracked_object/" class="md-nav__link">
        TrackedObject
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cost_functions/" class="md-nav__link">
        Cost functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/selection_functions/" class="md-nav__link">
        Selection functions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-cost-function" class="md-nav__link">
    Custom cost function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-selection-function" class="md-nav__link">
    Custom Selection function
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="designing-custom-cost-and-selection-functions">Designing custom cost and selection functions</h1>
<h2 id="custom-cost-function">Custom cost function</h2>
<p>In our codebase, a cost function is utilized to quantify the dissimilarity between two objects, specifically instances of <a href="../reference/tracked_object/">TrackedObject</a>. The cost function plays a pivotal role in the matching process within the <a href="../reference/matcher/">Matcher class</a>, where it computes a cost matrix. Each element in this matrix represents the cost of assigning a candidate to a switcher. For a deeper understanding of cost functions, please refer to the <a href="../reference/cost_functions/">related documentation</a>.</p>
<p>When initializing the <a href="../reference/reid_processor/">ReidProcessor</a>, you have the option to provide a custom cost function. The requirements for designing one are as follows:</p>
<ul>
<li>The cost function must accept 2 <a href="../reference/tracked_object/">TrackedObjects</a> instances: a candidate (a new object that appears and can potentially be matched), and a switcher (an object that has been lost and can potentially be re-matched).</li>
<li>All the <a href="../reference/tracked_object_metadata/">metadata</a> of each <a href="../reference/tracked_object/">TrackedObject</a> can be utilized to compute a cost.</li>
<li>If additional metadata is required, you should modify the <a href="../reference/tracked_object_metadata/">metadata</a> class accordingly. Please refer to the <a href="../quickstart_dev/">developer quickstart documentation</a> if needed.</li>
</ul>
<p>Here is an example of an Intersection over Union (IoU) distance function that you can use:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">bounding_box_iou_distance</span><span class="p">(</span><span class="n">candidate</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">,</span> <span class="n">switcher</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Intersection over Union (IoU) between the bounding boxes of two TrackedObjects.</span>
<span class="sd">    This measure is used as a measure of similarity between the two objects, with a higher IoU</span>
<span class="sd">    indicating a higher likelihood of the objects being the same.</span>

<span class="sd">    Args:</span>
<span class="sd">        candidate (TrackedObject): The first TrackedObject.</span>
<span class="sd">        switcher (TrackedObject): The second TrackedObject.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The IoU between the bounding boxes of the two TrackedObjects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the bounding boxes from the Metadata of each TrackedObject</span>
    <span class="n">bbox1</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">bbox</span>
    <span class="n">bbox2</span> <span class="o">=</span> <span class="n">switcher</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">bbox</span>

    <span class="c1"># Calculate the intersection of the bounding boxes</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="c1"># If the bounding boxes do not overlap, return 0</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">&lt;</span> <span class="n">x1</span> <span class="ow">or</span> <span class="n">y2</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Calculate the area of the intersection</span>
    <span class="n">intersection_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>

    <span class="c1"># Calculate the area of each bounding box</span>
    <span class="n">bbox1_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">bbox2_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">bbox2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">bbox2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Calculate the IoU</span>
    <span class="n">iou</span> <span class="o">=</span> <span class="n">intersection_area</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">bbox1_area</span> <span class="o">+</span> <span class="n">bbox2_area</span> <span class="o">-</span> <span class="n">intersection_area</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">iou</span>
</code></pre></div>

<p>Next, pass this function during the initialization of your <a href="../reference/reid_processor/">ReidProcessor</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">reid_processor</span> <span class="o">=</span> <span class="n">ReidProcessor</span><span class="p">(</span><span class="n">cost_function_threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                               <span class="n">cost_function</span> <span class="o">=</span> <span class="n">bounding_box_iou_distance</span><span class="p">,</span>
                               <span class="n">filter_confidence_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">filter_time_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_attempt_to_match</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_frames_to_rematch</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">save_to_txt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;your_file.txt&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In this case, candidates and switchers with bounding boxes will be matched if their IoU is below 0.7. Among possible matches, the two bounding boxes with the lowest cost (i.e., larger IoU) will be matched. You can use all the available metadata. For instance, here is an example of a cost function based on the difference in confidence:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">confidence_difference</span><span class="p">(</span><span class="n">candidate</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">,</span> <span class="n">switcher</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the absolute difference between the confidence values of two TrackedObjects.</span>
<span class="sd">    This measure is used as a measure of dissimilarity between the two objects, with a smaller difference</span>
<span class="sd">    indicating a higher likelihood of the objects being the same.</span>

<span class="sd">    Args:</span>
<span class="sd">        candidate (TrackedObject): The first TrackedObject.</span>
<span class="sd">        switcher (TrackedObject): The second TrackedObject.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The absolute difference between the confidence values of the two TrackedObjects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the confidence values from the Metadata of each TrackedObject</span>
    <span class="n">confidence1</span> <span class="o">=</span> <span class="n">candidate</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">confidence</span>
    <span class="n">confidence2</span> <span class="o">=</span> <span class="n">switcher</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">confidence</span>

    <span class="c1"># Calculate the absolute difference between the confidence values</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">confidence1</span> <span class="o">-</span> <span class="n">confidence2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">difference</span>
</code></pre></div>

<p>Then, pass this function during the initialization of your <a href="../reference/reid_processor/">ReidProcessor</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">reid_processor</span> <span class="o">=</span> <span class="n">ReidProcessor</span><span class="p">(</span><span class="n">cost_function_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                               <span class="n">cost_function</span> <span class="o">=</span> <span class="n">confidence_difference</span><span class="p">,</span>
                               <span class="n">filter_confidence_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">filter_time_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_attempt_to_match</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_frames_to_rematch</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">save_to_txt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;your_file.txt&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In this case, candidates and switchers will be matched if their confidence is similar, with a threshold acceptance of 0.1. Among possible matches, the two objects with the lowest cost (i.e., lower confidence difference) will be matched.</p>
<h2 id="custom-selection-function">Custom Selection function</h2>
<p>In the codebase, a selection function is used to determine whether two objects, specifically <a href="../reference/tracked_object/">TrackedObjects</a> instances, should be considered for matching. The selection function is a key part of the matching process in the <a href="../reference/matcher/">Matcher class</a>. For a deeper understanding of selection functions, please refer to the <a href="../reference/selection_functions/">related documentation</a>.</p>
<p>Here is an example of a selection function per zone that you can use:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Define the area of interest, [x_min, y_min, x_max, y_max]</span>
<span class="n">AREA_OF_INTEREST</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">select_by_area</span><span class="p">(</span><span class="n">candidate</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">,</span> <span class="n">switcher</span><span class="p">:</span> <span class="n">TrackedObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

    <span class="c1"># Check if both objects are inside the area of interest</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span>
        <span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">candidate</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span>
        <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span>
        <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">switcher</span><span class="o">.</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">AREA_OF_INTEREST</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</code></pre></div>

<p>Then, pass this function during the initialization of your <a href="../reference/reid_processor/">ReidProcessor</a>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">reid_processor</span> <span class="o">=</span> <span class="n">ReidProcessor</span><span class="p">(</span><span class="n">selection_function</span> <span class="o">=</span> <span class="n">select_by_area</span><span class="p">,</span>
                               <span class="n">filter_confidence_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">filter_time_threshold</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_attempt_to_match</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">max_frames_to_rematch</span><span class="o">=...</span><span class="p">,</span>
                               <span class="n">save_to_txt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;your_file.txt&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In this case, candidates and switchers will be considerated for matching if they belong to the same zone. You can of course combine selection functions, for instance to selection only switchers and candidates that belong to the same area and belong to the same category.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "content.tabs.link"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>